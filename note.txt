Текстовый редактор с подсветкой
###############################
Представляет собой модель MVC с управлением по таймеру.
те по таймеру выполняется прорисовка изображения на экране и сохранение данных из буфера редактора.

Функционально состоит из 3 блоков:
-- Блок хранения данных.
-- Блок отображения.
-- Буфер ввода текста.

В БХ посылается комманда на вывод строк из диапазона, который нужно отобразить (с указанеем начальной позиции).
Из БХ текстовые строки пересылаются в БО. Область, которую нужно перерисовать накапливается в отдельном буфере.
Строки храняться в виде записи - (строка; массив цветов(цвет; длина строки)). Если массив цветов отсутствует - строка отображается цветом по умолчанию.
По таймеру происходит перерисовка требуемой области отображения. Перерисовка выполняется последовательно для каждого цвета.
Так же по таймеру выполняется сборс данных в БХ. Если в БХ происходит расчет изменения цвета - цветовая карта пересылается в БО в асинхронном режиме.

Подстановка цветов выполняется блоком хранения (в фоновом режиме).

Для тестирования предлагается отображать альтернативным цветом ключевые слова (C#, Pascal) и комментарии ( --; /**/; //; (**); ; в начале строки; # в начале строки )

+------+                +-------+    block input
| Form |--------------->| Input |-------------------+
|      |                +---V---+                   |
|      |                    |                       |
|      |   +--------+   +---V---+   +-------+   +---V---+
|      |<=>| Buffer |<--|  Text |<=>|  Lex  |<=>| Text  |
|      |   |  BMP   |   |  View |   |       |   | Data  |
|      |   +--------+   |       |   |       |   |       |
|      |                |       |   |       |   |       |
+------+                +-----A-+   +-V---A-+   +-V-----+
                              |       |   |       |
							  +-------+   +-------+  уведомления об изменениях строк




========================================
24.09.2018

Предварительный макет готов. Он позволяет выводить на экран текст из файла.

Введем понятие курсора. Пусть это будет некая мигающая сущьность, координатами которой можно управлять с помощью стрелок на клавиатуре.
На вскидку может быть 3 варианта: прямоугольник, черта с правой стороны буквы, нижнее подчеркивание.
Для начала - проверим правильность вычисления размеров символов и введем буфер отображения из битмапа.

блок 
                if (s == null)
                {
                    s = new string('.', iW);
                }
                else {
                    int len = s.Length;
                    if (len < iW) s = s + new string('.', iW - len);
                    else s = s.Substring(0, iW);
                }
                buf[i] = s;
поправим
                if (s == null)
                {
                    s = new string('.', iW-1);
                }
                else {
                    int len = s.Length;
                    if (len < iW-1) s = s + new string('.', iW-1 - len);
                    else s = s.Substring(0, iW-1);
                }
                buf[i] = s;
